"use strict";(self.webpackChunkuix_2=self.webpackChunkuix_2||[]).push([[6264],{3905:(e,n,a)=>{a.d(n,{Zo:()=>r,kt:()=>C});var t=a(67294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function m(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?m(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,t,o=function(e,n){if(null==e)return{};var a,t,o={},m=Object.keys(e);for(t=0;t<m.length;t++)a=m[t],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);for(t=0;t<m.length;t++)a=m[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=t.createContext({}),d=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},r=function(e){var n=d(e.components);return t.createElement(s.Provider,{value:n},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,o=e.mdxType,m=e.originalType,s=e.parentName,r=l(e,["components","mdxType","originalType","parentName"]),c=d(a),u=o,C=c["".concat(s,".").concat(u)]||c[u]||h[u]||m;return a?t.createElement(C,i(i({ref:n},r),{},{components:a})):t.createElement(C,i({ref:n},r))}));function C(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var m=a.length,i=new Array(m);i[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[c]="string"==typeof e?e:o,i[1]=l;for(var d=2;d<m;d++)i[d]=a[d];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},71788:(e,n,a)=>{a.d(n,{Z:()=>m});var t=a(67294),o=a(34274);function m(e){let{children:n}=e;return t.createElement("div",{className:o.Z.filetitle},n)}},84473:(e,n,a)=>{a.d(n,{Z:()=>m});var t=a(67294),o=a(34274);function m(e){let{children:n}=e;return t.createElement("span",{className:o.Z.highlight},n)}},54930:(e,n,a)=>{a.d(n,{Z:()=>m});var t=a(67294),o=a(34274);function m(e){let{children:n}=e;return t.createElement("div",{className:o.Z.idea},n)}},67012:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>f,frontMatter:()=>s,metadata:()=>r,toc:()=>h});var t=a(87462),o=(a(67294),a(3905)),m=a(84473),i=a(71788),l=a(54930);const s={sidebar_position:2,sidebar_label:"Commands"},d="Commands",r={unversionedId:"Samples/Commands/index",id:"Samples/Commands/index",title:"Commands",description:"Overview",source:"@site/docs/Samples/Commands/index.mdx",sourceDirName:"Samples/Commands",slug:"/Samples/Commands/",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/Commands/",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Commands"},sidebar:"tutorialSidebar",previous:{title:"Hello, World",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/HelloWorld/"},next:{title:"ShowNewObjectWindow",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/ShowNewObjectWindow With Blank and UserDefined Template/"}},c={},h=[{value:"Overview",id:"overview",level:2},{value:"Creating the application structure",id:"creating-the-application-structure",level:2},{value:"Creating the application definition file",id:"creating-the-application-definition-file",level:3},{value:"Creating the module",id:"creating-the-module",level:3},{value:"Creating a button in the main menu",id:"creating-a-button-in-the-main-menu",level:2},{value:"Reacting when the command is clicked",id:"reacting-when-the-command-is-clicked",level:3},{value:"Adding a command to both the main menu and the context menu",id:"adding-a-command-to-both-the-main-menu-and-the-context-menu",level:2},{value:"Adding child command to the main menu",id:"adding-child-command-to-the-main-menu",level:2},{value:"Adding child command to the context menu",id:"adding-child-command-to-the-context-menu",level:2},{value:"Adding child command to custom command",id:"adding-child-command-to-custom-command",level:3},{value:"Adding child command to exist builtin submenu",id:"adding-child-command-to-exist-builtin-submenu",level:3},{value:"Showing and hiding buttons",id:"showing-and-hiding-buttons",level:2},{value:"Testing the application",id:"testing-the-application",level:2},{value:"Adding an icon",id:"adding-an-icon",level:2},{value:"Adding an builtin icon",id:"adding-an-builtin-icon",level:3}],u=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",n)},C=u("Tabs"),p=u("TabItem"),w={toc:h},I="wrapper";function f(e){let{components:n,...s}=e;return(0,o.kt)(I,(0,t.Z)({},w,s,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"commands"},"Commands"),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"This sample creates a basic User Interface Extensibility Framework application consisting of one ShellUI module which adds buttons to the main menu and context menu that are shown/hidden depending upon the user\u2019s actions."),(0,o.kt)("h2",{id:"creating-the-application-structure"},"Creating the application structure"),(0,o.kt)("h3",{id:"creating-the-application-definition-file"},"Creating the application definition file"),(0,o.kt)("p",null,"Into this folder we will create an application definition file. This file must be named ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"appdef.xml"),". The application will use version 4 of the client schema (as we are only targeting newer M-Files versions), and the supported platform will be set as newweb only. The application will declare a single Shell UI module (with its code in ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"main.js"),"), and no dashboards."),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"appdef.xml"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"xml",label:"XML",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.m-files.com/schemas/appdef-client-v5.xsd">\n    <guid>A50FF521-9167-4366-9CDE-6CB5C3BDDAFF</guid>\n    <name>Commands</name>\n    <version>0.1</version>\n    <description>A basic application showing how to work with commands.</description>\n    <publisher>M-Files Corporation</publisher>\n    <enabled-by-default>true</enabled-by-default>\n    <modules>\n        <module environment="shellui">\n        <file>main.js</file>\n        </module>\n    </modules>\n</application>\n')))),(0,o.kt)(l.Z,{mdxType:"Idea"},"Ensure that your application has a unique GUID by using a GUID generator."),(0,o.kt)("h3",{id:"creating-the-module"},"Creating the module"),(0,o.kt)("p",null,"Next we will create a module file to contain our actual application logic. At this point we will just register to be notified of main lifecycle events:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"We will declare a default entry point for the ShellUI module."),(0,o.kt)("li",{parentName:"ul"},"We will react to the ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"NewShellFrame")," event and obtain a reference to the shell frame."),(0,o.kt)("li",{parentName:"ul"},"We will react to the shell frame\u2019s ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"Started")," event (as using the shell frame before this point will result in an exception).")),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {};\n}\n')))),(0,o.kt)("h2",{id:"creating-a-button-in-the-main-menu"},"Creating a button in the main menu"),(0,o.kt)("p",null,"Adding a button into the main menu involves two steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creating a new ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"ICommand")," using CreateCustomCommand."),(0,o.kt)("li",{parentName:"ol"},"Adding the command into the menu using AddCustomCommandToMenu.")),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Add the first command to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n    };\n}\n')))),(0,o.kt)("p",null,"Logging into the M-Files vault should now show a button in the main menu (three dot menu near user icon) with the text ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"My First Command"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(55186).Z,title:"First command",width:"1253",height:"312"})),(0,o.kt)("h3",{id:"reacting-when-the-command-is-clicked"},"Reacting when the command is clicked"),(0,o.kt)("p",null,"Reacting to a command being clicked involves three steps:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Register to be notified of the CustomCommand event."),(0,o.kt)("li",{parentName:"ul"},"Ensure that the command that was clicked was the one we want to handle."),(0,o.kt)("li",{parentName:"ul"},"Execute the required code.")),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Add the first command to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n                }\n            } );\n\n    };\n}\n')))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(53016).Z,title:"First command clicked",width:"1062",height:"364"})),(0,o.kt)("h2",{id:"adding-a-command-to-both-the-main-menu-and-the-context-menu"},"Adding a command to both the main menu and the context menu"),(0,o.kt)("p",null,"To add a command created with CreateCustomCommand to the context menu, call AddCustomCommandToMenu. In the example below, it is the same command object added to both main menu and context menu, so our code to react when the button is clicked will be fired for the context menu item and the main menu item."),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first command to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n                }\n            } );\n\n    };\n}\n')))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(77504).Z,title:"Context menu",width:"1076",height:"882"})),(0,o.kt)("h2",{id:"adding-child-command-to-the-main-menu"},"Adding child command to the main menu"),(0,o.kt)("p",null,"Adding a child button into the main menu involves two steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creating a new ",(0,o.kt)("inlineCode",{parentName:"li"},"ICommand")," using CreateCustomCommand."),(0,o.kt)("li",{parentName:"ol"},"Adding the command into main menu using CreateSubMenuItem by giving the parent command id.")),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first and second commands to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        const parentMenuItemId = await shellFrame.Commands.AddCustomCommandToMenu( commandTwoId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Create child commands (buttons).\n        const commandChildOneId = await shellFrame.Commands.CreateCustomCommand( "My First Child Command" );\n        const commandChildTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Child Command" );\n\n        // Add created child comamnds to the parent.\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n\n                    case commandChildOneId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My child command clicked." );\n                        break;\n                }\n            } );\n    };\n}\n')))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(62366).Z,title:"Child Command",width:"1252",height:"407"})),(0,o.kt)("h2",{id:"adding-child-command-to-the-context-menu"},"Adding child command to the context menu"),(0,o.kt)("h3",{id:"adding-child-command-to-custom-command"},"Adding child command to custom command"),(0,o.kt)("p",null,"Adding a child button to custom command involves two steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creating a new ",(0,o.kt)("inlineCode",{parentName:"li"},"ICommand")," using CreateCustomCommand."),(0,o.kt)("li",{parentName:"ol"},"Adding the command into context menu using CreateSubMenuItem by giving the parent command id.")),(0,o.kt)("h3",{id:"adding-child-command-to-exist-builtin-submenu"},"Adding child command to exist builtin submenu"),(0,o.kt)("p",null,"Adding a child button to exist builtin submenu command involves three steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creating a new ",(0,o.kt)("inlineCode",{parentName:"li"},"ICommand")," using CreateCustomCommand."),(0,o.kt)("li",{parentName:"ol"},"Getting parent menu item id using GetMenuIdOfBuiltInCommand."),(0,o.kt)("li",{parentName:"ol"},"Adding the command into context menu using CreateSubMenuItem by giving the parent menu item id.")),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first and second commands to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        const parentMenuItemId = await shellFrame.Commands.AddCustomCommandToMenu( commandTwoId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Create child commands (buttons).\n        const commandChildOneId = await shellFrame.Commands.CreateCustomCommand( "My First Child Command" );\n        const commandChildTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Child Command" );\n\n        // Add created child comamnds to the parent.\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n        // Create child command to add exist submenu in the listing context menu.\n        const commandChildThreeId = await shellFrame.Commands.CreateCustomCommand( "My Custom Convert Command" );\n\n        // Get built in parent command menu id. Ex. Convert.\n        const convertMenuId = await shellFrame.Commands.GetMenuIdOfBuiltInCommand( MFiles.BuiltinCommand.SubMenu_Convert, MFiles.CommandLocation.ContextMenu );\n\n        // Add child command to the exist convert menu.\n        await shellFrame.Commands.CreateSubMenuItem( convertMenuId, commandChildThreeId, 0 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n\n                    case commandChildOneId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My child command clicked." );\n                        break;\n                }\n            } );\n    };\n}\n')))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(49782).Z,title:"Child Command",width:"1568",height:"876"})),(0,o.kt)("h2",{id:"showing-and-hiding-buttons"},"Showing and hiding buttons"),(0,o.kt)("p",null,"The visibility of commands can be controlled by calling ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"SetCommandState"),". To show this, we will toggle the first command visibility on clicking the child command."),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first and second commands to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        const parentMenuItemId = await shellFrame.Commands.AddCustomCommandToMenu( commandTwoId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Create child commands (buttons).\n        const commandChildOneId = await shellFrame.Commands.CreateCustomCommand( "My First Child Command" );\n        const commandChildTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Child Command" );\n\n        // Add created child commands to the parent in the main menu.\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\n        const childMenuItem = await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n        // Create nested child command and add to the parent in the main menu.\n        const toggleCommand = await shellFrame.Commands.CreateCustomCommand( "Toggle First Command Visibility" );\n        await shellFrame.Commands.CreateSubMenuItem( childMenuItem, toggleCommand, 1 );\n\n        // Create child command to add exist submenu in the listing context menu.\n        const commandChildThreeId = await shellFrame.Commands.CreateCustomCommand( "My Custom Convert Command" );\n\n        // Get built in parent command menu id. Ex. Convert.\n        const convertMenuId = await shellFrame.Commands.GetMenuIdOfBuiltInCommand( MFiles.BuiltinCommand.SubMenu_Convert, MFiles.CommandLocation.ContextMenu );\n\n        // Add child command to the exist convert menu.\n        await shellFrame.Commands.CreateSubMenuItem( convertMenuId, commandChildThreeId, 0 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n\n                    case commandChildOneId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My child command clicked." );\n                        break;\n\n                    case commandChildThreeId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My convert child command clicked." );\n                        break;\n\n                    case toggleCommand:\n\n                        // Get the first command state and toggle it.\n                        let firstCommandState = await shellFrame.Commands.GetCommandState( commandOneId, MFiles.CommandLocation.MainMenu, false, false );\n                        firstCommandState = firstCommandState === MFiles.CommandState.CommandState_Hidden\n                            ? MFiles.CommandState.CommandState_Active\n                            : MFiles.CommandState.CommandState_Hidden;\n\n                        // Toggle the command state and show message.\n                        await shellFrame.Commands.SetCommandState( commandOneId, MFiles.CommandLocation.All, firstCommandState );\n\n                        // Show the message.\n                        const message = firstCommandState === MFiles.CommandState.CommandState_Active\n                            ? "First command visibility enabled"\n                            : "First command visibility disabled"\n                        await shellFrame.ShowMessage( message );\n                        break;\n                }\n            } );\n    };\n}\n')))),(0,o.kt)("h2",{id:"testing-the-application"},"Testing the application"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(61174).Z,title:"Hide Show Commands",width:"1924",height:"881"}),"\n",(0,o.kt)("img",{alt:" alt text ",src:a(5889).Z,title:"Hide Show Commands",width:"1924",height:"881"})),(0,o.kt)("h2",{id:"adding-an-icon"},"Adding an icon"),(0,o.kt)("p",null,"To set an command icon, call ",(0,o.kt)(m.Z,{mdxType:"Highlight"},(0,o.kt)("inlineCode",{parentName:"p"},"SetIcon(customCommand, iconInformation)")),". The function validates the inputs, resolves the icon described by ",(0,o.kt)("inlineCode",{parentName:"p"},"iconInformation"),", and \u2014 if resolution succeeds \u2014 updates the command's ",(0,o.kt)("inlineCode",{parentName:"p"},"icon")," field. If the command id is not found, the function throws an invalid argument error; if icon resolution fails (network, parsing, etc.) the error is logged and the command is left unchanged."),(0,o.kt)("p",null,"Parameters"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"customCommand")," (number) \u2013 id of the custom command to update. Must be a command that exists in ",(0,o.kt)("inlineCode",{parentName:"li"},"mFilesCommon"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"iconInformation")," (IIconInformation) \u2013 description of the icon source and metadata (content type, content string or id, optional extension).")),(0,o.kt)("p",null,"How it works"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Validates inputs. If ",(0,o.kt)("inlineCode",{parentName:"li"},"customCommand")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"iconInformation")," is null/undefined, the call throws immediately."),(0,o.kt)("li",{parentName:"ol"},"Looks up the command."),(0,o.kt)("li",{parentName:"ol"},"Resolves the icon."),(0,o.kt)("li",{parentName:"ol"},"If icon resolution returns a non-null value, assign it to command's icon.")),(0,o.kt)("p",null,"Key notes"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Signature: ",(0,o.kt)("inlineCode",{parentName:"li"},"async SetIcon(customCommand: number, iconInformation: IIconInformation): Promise<void>")),(0,o.kt)("li",{parentName:"ul"},"Stability: Experimental \u2014 API may change."),(0,o.kt)("li",{parentName:"ul"},"Inline SVG strings: if ",(0,o.kt)("inlineCode",{parentName:"li"},"iconInformation")," contains raw SVG markup, the system treats it as SVG; the helper will default missing extension to ",(0,o.kt)("inlineCode",{parentName:"li"},"svg")," and encode the content to a base64 data URI for reliable rendering."),(0,o.kt)("li",{parentName:"ul"},"PATH resources: the loader uses ",(0,o.kt)("inlineCode",{parentName:"li"},"fetch")," then converts the response to a data URI. Same-origin/CORS restrictions apply."),(0,o.kt)("li",{parentName:"ul"},"Built-in icons: when using a built-in id, corresponding icon is being added to command and unknown built-in ids result in no icon being set.")),(0,o.kt)("p",null,"Icon can be added to every menu location."),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create custom commands.\n        const commandIconSVGPathId = await shellFrame.Commands.CreateCustomCommand( "Command icon SVG path" );\n        const commandIconSVGBase64Id = await shellFrame.Commands.CreateCustomCommand( "Command icon SVG base64" );\n        const commandIconSVGStringId = await shellFrame.Commands.CreateCustomCommand( "Command icon SVG string" );\n        const commandIconPNGPathId = await shellFrame.Commands.CreateCustomCommand( "Command icon PNG path" );\n        const commandIconICOId = await shellFrame.Commands.CreateCustomCommand( "Command icon (ICO)" );\n        const commandIconJPGPathId = await shellFrame.Commands.CreateCustomCommand( "Command icon JPG path" );\n        const commandIconJPEGPathId = await shellFrame.Commands.CreateCustomCommand( "Command icon JPEG path" );\n\n        // Create IIconInformation interface for each supported icon.\n        const SVGPathIdIconInformation = { content: "icons/analyze.svg", iconContentType: "PATH", alt: "SVG icon alt", extension: "svg" };\n        const SVGBase64IconInformation = { content: svgBase64, iconContentType: "BASE64", alt: "SVG base64 icon alt", extension: "svg" };\n        const SVGStringIconInformation = { content: svgString, iconContentType: "SVG", alt: "SVG string icon alt", extension: "svg" };\n        const PNGPathIdIconInformation = { content: "icons/vault.png", iconContentType: "PATH", alt: "PNG icon alt", extension: "png" };\n        const ICOPathIdIconInformation = { content: "icons/word.ico", iconContentType: "PATH", alt: "ICO icon alt", extension: "ico" };\n        const JPGPathIdIconInformation = { content: "icons/image_cropped.jpg", iconContentType: "PATH", alt: "JPG icon alt", extension: "jpg" };\n        const JPEGPathIdIconInformation = { content: "icons/image2_cropped.jpeg", iconContentType: "PATH", alt: "JPEG icon alt", extension: "jpeg" };\n\n        try {\n\n            // Set icons.\n            await shellFrame.Commands.SetIcon( commandIconSVGPathId, SVGPathIdIconInformation );\n            await shellFrame.Commands.SetIcon( commandIconSVGBase64Id, SVGBase64IconInformation );\n            await shellFrame.Commands.SetIcon( commandIconSVGStringId, SVGStringIconInformation );\n            await shellFrame.Commands.SetIcon( commandIconPNGPathId, PNGPathIdIconInformation );\n            await shellFrame.Commands.SetIcon( commandIconICOId, ICOPathIdIconInformation );\n            await shellFrame.Commands.SetIcon( commandIconJPGPathId, JPGPathIdIconInformation );\n            await shellFrame.Commands.SetIcon( commandIconJPEGPathId, JPEGPathIdIconInformation );\n        }\n        catch ( error ) {\n\n            // Log the error.\n            console.error( "Error setting icon:", error );\n        }\n\n        // Add commands to top pane menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGPathId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGBase64Id, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGStringId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconPNGPathId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconICOId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPGPathId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPEGPathId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Add commands to context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGPathId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGBase64Id, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGStringId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconPNGPathId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconICOId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPGPathId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPEGPathId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add commands to activity context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGPathId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGBase64Id, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGStringId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconPNGPathId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconICOId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPGPathId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPEGPathId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1 );\n\n        // Add commands to taskbar.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGPathId,  MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGBase64Id, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconSVGStringId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconPNGPathId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconICOId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPGPathId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );  \n        await shellFrame.Commands.AddCustomCommandToMenu( commandIconJPEGPathId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Handle command clicks.\n            } );\n    };\n}\n')))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(76150).Z,title:"Icons in taskbar",width:"1996",height:"1166"})),(0,o.kt)("h3",{id:"adding-an-builtin-icon"},"Adding an builtin icon"),(0,o.kt)("p",null,"An builtin icon for a command can be added similar way than normal icon by calling ",(0,o.kt)(m.Z,{mdxType:"Highlight"},"SetIcon")," with icon information interface.\nBuiltin icon can be added to every menu location as well."),(0,o.kt)(i.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(C,{mdxType:"Tabs"},(0,o.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Some builtin icons and their values.\n        const builtInIcons = [\n            { name: "CheckOut", value: 0 },\n            { name: "CheckIn", value: 1 },\n            { name: "Undo", value: 13 },\n        ];\n\n        // Create commands and set built-in icons.\n        for (const bi of builtInIcons) {\n\n            // Create command for corresponding icon.\n            const cmdId = await shellFrame.Commands.CreateCustomCommand(`Built-in: ${bi.name}`);\n\n            // Construct icon information and set icon.\n            const iconInfo = { content: bi.value, iconContentType: "BUILT_IN", alt: `${bi.name} built-in icon`, extension: "" };\n            await shellFrame.Commands.SetIcon(cmdId, iconInfo);\n\n            // Add to a all menus so you can see it in different places.\n            await shellFrame.Commands.AddCustomCommandToMenu(cmdId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1);\n            await shellFrame.Commands.AddCustomCommandToMenu(cmdId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1);\n            await shellFrame.Commands.AddCustomCommandToMenu(cmdId, MFiles.MenuLocation.MenuLocation_ActivityContextMenu_1, 1);\n            await shellFrame.Commands.AddCustomCommandToMenu(cmdId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1);\n        }\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Handle command clicks.\n            } );\n    };\n}\n')))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(29807).Z,title:"Builtin icons in taskbar",width:"2234",height:"1276"})))}f.isMDXComponent=!0},34274:(e,n,a)=>{a.d(n,{Z:()=>t});const t={note:"note_XMqZ",idea:"idea_NLbw",highlight:"highlight_NFmx",filetitle:"filetitle_Jrus"}},55186:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_1-7155073040a14531cef4b5c3b51626dc.png"},53016:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_2-49f709618eb706dd5912f5c52df7a1c3.png"},77504:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_3-c8148bb22e501e5471b6553619f7323b.png"},62366:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_4-3f91ab15528b6cb15a47a4a0ddc4b745.png"},49782:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_5-ae3f172688624599f4c8b8c7c38b2c16.png"},61174:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_6-908cf9e788788160cce212b046b6349f.png"},5889:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_7-1aa8073379e40aaf90e8b07fbafe0840.png"},76150:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_8-e254bb41f0a4814a0fe6f62cd1a679cd.png"},29807:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/Commands_9-bd4fdce55a813cb5083a453dbe387961.png"}}]);