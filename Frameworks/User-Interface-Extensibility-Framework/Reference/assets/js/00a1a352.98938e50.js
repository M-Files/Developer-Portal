"use strict";(self.webpackChunkuix_2=self.webpackChunkuix_2||[]).push([[9027],{3905:(e,n,a)=>{a.d(n,{Zo:()=>d,kt:()=>p});var t=a(67294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function l(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,t,o=function(e,n){if(null==e)return{};var a,t,o={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var i=t.createContext({}),m=function(e){var n=t.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):l(l({},n),e)),a},d=function(e){var n=m(e.components);return t.createElement(i.Provider,{value:n},e.children)},h="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),h=m(a),u=o,p=h["".concat(i,".").concat(u)]||h[u]||c[u]||r;return a?t.createElement(p,l(l({ref:n},d),{},{components:a})):t.createElement(p,l({ref:n},d))}));function p(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=u;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s[h]="string"==typeof e?e:o,l[1]=s;for(var m=2;m<r;m++)l[m]=a[m];return t.createElement.apply(null,l)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},71788:(e,n,a)=>{a.d(n,{Z:()=>r});var t=a(67294),o=a(34274);function r(e){let{children:n}=e;return t.createElement("div",{className:o.Z.filetitle},n)}},84473:(e,n,a)=>{a.d(n,{Z:()=>r});var t=a(67294),o=a(34274);function r(e){let{children:n}=e;return t.createElement("span",{className:o.Z.highlight},n)}},54930:(e,n,a)=>{a.d(n,{Z:()=>r});var t=a(67294),o=a(34274);function r(e){let{children:n}=e;return t.createElement("div",{className:o.Z.idea},n)}},47441:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>h,contentTitle:()=>m,default:()=>k,frontMatter:()=>i,metadata:()=>d,toc:()=>c});var t=a(87462),o=(a(67294),a(3905)),r=a(84473),l=a(71788),s=a(54930);const i={sidebar_position:3,sidebar_label:"Taskbar Commands"},m="Taskbar Commands",d={unversionedId:"Samples/TaskbarCommands/index",id:"Samples/TaskbarCommands/index",title:"Taskbar Commands",description:"Overview",source:"@site/docs/Samples/TaskbarCommands/index.mdx",sourceDirName:"Samples/TaskbarCommands",slug:"/Samples/TaskbarCommands/",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/TaskbarCommands/",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,sidebar_label:"Taskbar Commands"},sidebar:"tutorialSidebar",previous:{title:"Built-in Command Demonstration",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/BuiltInCommands/"},next:{title:"PopUp Dashboard",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/PopupDashboard/"}},h={},c=[{value:"Overview",id:"overview",level:2},{value:"Creating the application structure",id:"creating-the-application-structure",level:2},{value:"Creating the application definition file",id:"creating-the-application-definition-file",level:3},{value:"Creating the module",id:"creating-the-module",level:3},{value:"Adding button to a taskbar group",id:"adding-button-to-a-taskbar-group",level:2},{value:"Reacting when the command is clicked",id:"reacting-when-the-command-is-clicked",level:3},{value:"Creating a custom taskbar command group and adding commands to it",id:"creating-a-custom-taskbar-command-group-and-adding-commands-to-it",level:2},{value:"Creating a submenu in the taskbar and adding commands to it",id:"creating-a-submenu-in-the-taskbar-and-adding-commands-to-it",level:2},{value:"Hiding and displaying commands in taskbar",id:"hiding-and-displaying-commands-in-taskbar",level:2},{value:"Adding an icon",id:"adding-an-icon",level:2}],u=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",n)},p=u("Tabs"),g=u("TabItem"),w={toc:c},b="wrapper";function k(e){let{components:n,...i}=e;return(0,o.kt)(b,(0,t.Z)({},w,i,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"taskbar-commands"},"Taskbar Commands"),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"This sample creates a basic User Interface Extensibility Framework application consisting of one module which adds a new command group to the taskbar and commands to it. It also adds commands to pre-defined command groups in taskbar."),(0,o.kt)("h2",{id:"creating-the-application-structure"},"Creating the application structure"),(0,o.kt)("h3",{id:"creating-the-application-definition-file"},"Creating the application definition file"),(0,o.kt)("p",null,"Into this folder we will create an application definition file. This file must be named ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"appdef.xml"),". The application will use version 5 of the client schema (as we are only targeting newer M-Files versions). The application will declare a single Shell UI module (with its code in ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"main.js"),"), and no dashboards."),(0,o.kt)(l.Z,{mdxType:"FileTitle"},"appdef.xml"),(0,o.kt)(p,{mdxType:"Tabs"},(0,o.kt)(g,{value:"xml",label:"XML",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.m-files.com/schemas/appdef-client-v5.xsd">\n    <guid>99EEA8CD-B990-4379-AFF9-D9DF2E2147E4</guid>\n    <name>TaskBar Commands</name>\n    <version>0.1</version>\n    <description>A basic application showing how to work with commands in taskbar.</description>\n    <publisher>M-Files Corporation</publisher>\n    <enabled-by-default>true</enabled-by-default>\n    <modules>\n        <module environment="shellui">\n        <file>main.js</file>\n        </module>\n    </modules>\n</application>\n')))),(0,o.kt)(s.Z,{mdxType:"Idea"},"Ensure that your application has a unique GUID by using a GUID generator."),(0,o.kt)("h3",{id:"creating-the-module"},"Creating the module"),(0,o.kt)("p",null,"Next we will create a module file to contain our actual application logic. At this point we will just register to be notified of main lifecycle events:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"We will declare a default entry point for the ShellUI module."),(0,o.kt)("li",{parentName:"ul"},"We will react to the ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"NewShellFrame")," event and obtain a reference to the shell frame."),(0,o.kt)("li",{parentName:"ul"},"We will react to the shell frame\u2019s ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"Started")," event (as using the shell frame before this point will result in an exception).")),(0,o.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(p,{mdxType:"Tabs"},(0,o.kt)(g,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {};\n}\n')))),(0,o.kt)("h2",{id:"adding-button-to-a-taskbar-group"},"Adding button to a taskbar group"),(0,o.kt)("p",null,"Command buttons are divided into groups on the taskbar."),(0,o.kt)("p",null,"Adding a button into existing taskbar group involves two steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creating a new ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"ICommand")," using ",(0,o.kt)("a",{parentName:"li",href:"/UIExt2/Interfaces/ICommands/CreateCustomCommand"},"CreateCustomCommand"),"."),(0,o.kt)("li",{parentName:"ol"},"Adding the command into the taskbar group using ",(0,o.kt)("a",{parentName:"li",href:"/UIExt2/Interfaces/ICommands/AddCustomCommandToMenu"},"AddCustomCommandToMenu"),".")),(0,o.kt)("p",null,"Note: The AddCustomCommandToMenu function takes three parameters: the command ID, the ",(0,o.kt)("a",{parentName:"p",href:"/UIExt2/Enums/MenuLocation"},"MenuLocation"),", and the order priority."),(0,o.kt)("p",null,"MenuLocation specifies where the button will be added. If the button is added to a menu location associated with a built-in taskbar group, such as MenuLocation_TaskBar_MainActions, it will appear in the corresponding group on the taskbar (for example, the 'Main actions' group)."),(0,o.kt)("p",null,"Order priority determines the button's position within the group; buttons with lower priority values are shown first."),(0,o.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(p,{mdxType:"Tabs"},(0,o.kt)(g,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button). Note that it is not yet visible.\n        const helloCommandId = await shellFrame.Commands.CreateCustomCommand( "Hello World" );\n\n        // Add the command to the \'Main actions\' command group in taskbar.\n        await shellFrame.Commands.AddCustomCommandToMenu( helloCommandId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 99 );\n    };\n}\n')))),(0,o.kt)("p",null,"Logging into the M-Files vault should now show a button in the taskbar 'Main actions' group with the text ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"Hello World"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(70605).Z,title:"Hello World command",width:"536",height:"376"})),(0,o.kt)("p",null,"Note that the 'Main actions' group also includes other built-in commands, which may vary depending on the current selection."),(0,o.kt)("h3",{id:"reacting-when-the-command-is-clicked"},"Reacting when the command is clicked"),(0,o.kt)("p",null,"Reacting to a command being clicked involves three steps:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Register to be notified of the CustomCommand event."),(0,o.kt)("li",{parentName:"ul"},"Ensure that the command that was clicked was the one we want to handle."),(0,o.kt)("li",{parentName:"ul"},"Execute the required code.")),(0,o.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(p,{mdxType:"Tabs"},(0,o.kt)(g,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button). Note that it is not yet visible.\n        const helloCommandId = await shellFrame.Commands.CreateCustomCommand( "Hello World" );\n\n        // Add the command to the \'Main actions\' command group in taskbar.\n        await shellFrame.Commands.AddCustomCommandToMenu( helloCommandId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 99 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case helloCommandId:\n\n                        // Hello command was clicked.\n                        await shellFrame.ShowMessage( "Hello, World!" );\n                        break;\n                }\n            } );\n\n    };\n}\n')))),(0,o.kt)("h2",{id:"creating-a-custom-taskbar-command-group-and-adding-commands-to-it"},"Creating a custom taskbar command group and adding commands to it"),(0,o.kt)("p",null,"To create a new taskbar command group, call the ",(0,o.kt)("a",{parentName:"p",href:"/UIExt2/Interfaces/ICommands/CreateTaskbarGroup/"},"CreateTaskbarGroup")," function. It returns a new MenuLocation that can be used in the ",(0,o.kt)("a",{parentName:"p",href:"/UIExt2/Interfaces/ICommands/AddCustomCommandToMenu/"},"AddCustomCommandToMenu"),' call. In the example below, a new command group is created in the taskbar, and three commands ("Open", "Apply", and "Print") are added to it.'),(0,o.kt)("p",null,"The CreateTaskbarGroup function takes three parameters: the group name, the group\u2019s location within the taskbar, and the ordering priority."),(0,o.kt)("p",null,"The group location defines where in the taskbar the new group will appear. For example, it can be the leftmost group (",(0,o.kt)("inlineCode",{parentName:"p"},"MenuLocation_TaskBar_First"),"),\nafter the 'Main actions' built-in group (",(0,o.kt)("inlineCode",{parentName:"p"},"MenuLocation_TaskBar_MainActions"),"), or the rightmost group (",(0,o.kt)("inlineCode",{parentName:"p"},"MenuLocation_TaskBar_Last"),")."),(0,o.kt)("p",null,"The ordering priority determines the order of groups within the same taskbar menu location; groups with the smallest priority values appear on the left."),(0,o.kt)("p",null,"Note that empty command groups are not displayed. You must add commands to the group for it to become visible."),(0,o.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(p,{mdxType:"Tabs"},(0,o.kt)(g,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command group in taskbar. Note that it is not yet visible.\n        const myGroupId = await shellFrame.Commands.CreateTaskbarGroup( "My App", MFiles.MenuLocation.MenuLocation_TaskBar_Last, 1 );\n\n        // Create commands to be added to the taskbar command group.\n        const openCmdId = await shellFrame.Commands.CreateCustomCommand( "Open" );\n        const applyCmdId = await shellFrame.Commands.CreateCustomCommand( "Apply" );\n        const printCmdId = await shellFrame.Commands.CreateCustomCommand( "Print" );\n\n        // Add the commands to the custom command group. Commands are displayed in priority order.\n        await shellFrame.Commands.AddCustomCommandToMenu( openCmdId, myGroupId, 1 );\n        await shellFrame.Commands.AddCustomCommandToMenu( applyCmdId, myGroupId, 2 );\n        await shellFrame.Commands.AddCustomCommandToMenu( printCmdId, myGroupId, 3 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case openCmdId:\n\n                        // Open command was clicked.\n                        await shellFrame.ShowMessage( "Open command" );\n                        break;\n\n                    case applyCmdId:\n\n                        // Apply command was clicked.\n                        await shellFrame.ShowMessage( "Apply command" );\n                        break;\n\n                    case printCmdId:\n\n                        // Print command was clicked.\n                        await shellFrame.ShowMessage( "Print command" );\n                        break;\n                }\n            } );\n\n    };\n}\n')))),(0,o.kt)("p",null,"Logging into the M-Files vault should now show a ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"My App")," command group in taskbar and the three commands in it:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(67233).Z,title:"Custom command group with three commands",width:"606",height:"377"})),(0,o.kt)("h2",{id:"creating-a-submenu-in-the-taskbar-and-adding-commands-to-it"},"Creating a submenu in the taskbar and adding commands to it"),(0,o.kt)("p",null,"Taskbar commands can be organized into submenus. A submenu can contain menu items (i.e. commands) as well as other, more deeply nested submenus."),(0,o.kt)("p",null,"Creating a menu item that opens a submenu involves several steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create a new ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"ICommand")," using ",(0,o.kt)("a",{parentName:"li",href:"/UIExt2/Interfaces/ICommands/CreateCustomCommand"},"CreateCustomCommand"),"."),(0,o.kt)("li",{parentName:"ol"},"Add the command to the taskbar group using ",(0,o.kt)("a",{parentName:"li",href:"/UIExt2/Interfaces/ICommands/AddCustomCommandToMenu"},"AddCustomCommandToMenu"),"."),(0,o.kt)("li",{parentName:"ol"},"For each submenu command:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Create a new ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"ICommand")," using ",(0,o.kt)("a",{parentName:"li",href:"/UIExt2/Interfaces/ICommands/CreateCustomCommand"},"CreateCustomCommand"),"."),(0,o.kt)("li",{parentName:"ul"},"Create a new submenu item for the command using ",(0,o.kt)("a",{parentName:"li",href:"/UIExt2/Interfaces/ICommands/CreateSubMenuItem"},"CreateSubMenuItem"),".")))),(0,o.kt)("p",null,'Example code below creates a taskbar group called "My App", and adds a menu item "Menu" to it. This menu item opens a submenu containing one command "Greet" and a nested submenu "SubMenu". The nested submenu includes two commands: "Hello" and "World".'),(0,o.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,o.kt)(p,{mdxType:"Tabs"},(0,o.kt)(g,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI(shellUI) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame);\n}\n\nfunction handleNewShellFrame(shellFrame) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler(shellFrame));\n}\n\nfunction getShellFrameStartedHandler(shellFrame) {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command group in taskbar. Note that it is not yet visible.\n        const myGroupId = await shellFrame.Commands.CreateTaskbarGroup("My App", MFiles.MenuLocation.MenuLocation_TaskBar_Last, 1);\n\n        // Create a custom command to be added to the taskbar command group.\n        // It contains menu when submenu items are added into it.\n        const mainMenuCmd = await shellFrame.Commands.CreateCustomCommand("Menu");\n        const mainMenuId = await shellFrame.Commands.AddCustomCommandToMenu(mainMenuCmd, myGroupId, 1);\n\n        // Create "Greet" command and add it to the main menu.\n        const commandGreetId = await shellFrame.Commands.CreateCustomCommand("Greet");\n        const commandGreetMenuId = await shellFrame.Commands.CreateSubMenuItem(mainMenuId, commandGreetId, 1);\n\n        // Create "SubMenu" command and add it to the main menu.\n        const subMenuCmd = await shellFrame.Commands.CreateCustomCommand("SubMenu");\n        const subMenuId = await shellFrame.Commands.CreateSubMenuItem(mainMenuId, subMenuCmd, 2);\n\n        // Create "Hello" command and add it to the nested menu.\n        const helloCommandId = await shellFrame.Commands.CreateCustomCommand("Hello");\n        const helloMenuId = await shellFrame.Commands.CreateSubMenuItem(subMenuId, helloCommandId, 1);\n\n        // Create "World" command and add it to the nested menu.\n        const worldCommandId = await shellFrame.Commands.CreateCustomCommand("World");\n        const worldMenuId = await shellFrame.Commands.CreateSubMenuItem(subMenuId, worldCommandId, 2);\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async (commandId) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandGreetId:\n\n                        // Greet command was clicked.\n                        await shellFrame.ShowMessage("Hello, World!");\n                        break;\n\n                    case helloCommandId:\n\n                        // Hello command was clicked.\n                        await shellFrame.ShowMessage("Hello");\n                        break;\n\n                    case worldCommandId:\n\n                        // World command was clicked.\n                        await shellFrame.ShowMessage("World");\n                        break;\n                }\n            });\n    };\n}\n')))),(0,o.kt)("p",null,"Logging into the M-Files vault should now show a ",(0,o.kt)(r.Z,{mdxType:"Highlight"},"My App")," command group in taskbar and the commands with submenus in it:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(71378).Z,title:"Custom taskbar commands in a submenu",width:"581",height:"363"})),(0,o.kt)("h2",{id:"hiding-and-displaying-commands-in-taskbar"},"Hiding and displaying commands in taskbar"),(0,o.kt)("p",null,"The command can be hidden from the taskbar using the ",(0,o.kt)("a",{parentName:"p",href:"/UIExt2/Interfaces/ICommands/SetCommandState"},"SetCommandState")," function."),(0,o.kt)("p",null,"SetCommandState function takes three parameters:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The command id."),(0,o.kt)("li",{parentName:"ol"},"The command location (i.e. where the command state should be changed)."),(0,o.kt)("li",{parentName:"ol"},"The new command state.")),(0,o.kt)("p",null,"To hide or show commands in the taskbar, use the ",(0,o.kt)("strong",null,"CommandLocation.TaskBar")," ",(0,o.kt)("a",{parentName:"p",href:"/UIExt2/Enums/CommandLocation"},"command location"),"."),(0,o.kt)("p",null,"Use the following ",(0,o.kt)("a",{parentName:"p",href:"/UIExt2/Enums/CommandState"},"command states"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)(r.Z,{mdxType:"Highlight"},"CommandState_Active")," to show the command."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)(r.Z,{mdxType:"Highlight"},"CommandState_Hidden")," to hide the command.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"// Example: show or hide the command with commandId in taskbar.\nconst newState = isCommandAvailable ? CommandState.CommandState_Active : CommandState.CommandState_Hidden;\nawait shellFrame.Commands.SetCommandState( commandId, MFiles.CommandLocation.TaskBar, newState );\n")),(0,o.kt)("p",null,"When a new command is created and added to the taskbar, its command state is CommandState_Active by default."),(0,o.kt)("h2",{id:"adding-an-icon"},"Adding an icon"),(0,o.kt)("p",null,"To set an icon for an existing custom taskbar group, call ",(0,o.kt)("inlineCode",{parentName:"p"},"SetTaskbarGroupIcon(groupId, iconInformation)")," to update the icon shown for a taskbar group created by your application. The function verifies feature availability and ownership, resolves the icon using the same helpers as ",(0,o.kt)("inlineCode",{parentName:"p"},"SetIcon"),", applies the icon to the group, and refreshes the taskbar so the new icon is visible."),(0,o.kt)("p",null,"Parameters"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"groupId")," (number) \u2013 id of the taskbar group to update. The group must be created by your app and owned by its Application GUID."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"iconInformation")," (IIconInformation) \u2013 description of the icon (inline SVG, base64, path, built-in id, etc.).")),(0,o.kt)("p",null,"How it works"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Validates inputs; throws on null/undefined parameters."),(0,o.kt)("li",{parentName:"ol"},"Reads the application GUID and verifies ownership; throws if the group is missing or not owned by the app."),(0,o.kt)("li",{parentName:"ol"},"Resolves the icon and sets ",(0,o.kt)("inlineCode",{parentName:"li"},"group.icon"),"."),(0,o.kt)("li",{parentName:"ol"},"Refreshes taskbar commands, so the UI updates.")),(0,o.kt)("p",null,"Key notes"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Signature: ",(0,o.kt)("inlineCode",{parentName:"li"},"async SetTaskbarGroupIcon(groupId: number, iconInformation: IIconInformation): Promise<void>")),(0,o.kt)("li",{parentName:"ul"},"Stability: Experimental \u2014 API may change."),(0,o.kt)("li",{parentName:"ul"},"Ownership required: the call uses the application GUID; you must own the taskbar group to modify it."),(0,o.kt)("li",{parentName:"ul"},"Icon resolution: same rules as ",(0,o.kt)("inlineCode",{parentName:"li"},"SetIcon")," (inline SVG default extension ",(0,o.kt)("inlineCode",{parentName:"li"},"svg"),", PATH requires fetch/CORS, built-in ids map to icon helpers)."),(0,o.kt)("li",{parentName:"ul"},"Errors: throws when parameters are missing, when appGUID is not available, or when the group does not exist / ownership verification fails. If ",(0,o.kt)("inlineCode",{parentName:"li"},"getIcon")," throws, the error is wrapped and re-thrown with a failure message.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// Base64-encoded SVG icon for the group\nconst groupIconBase64 = \'PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMTRBNiA2IDAgMSAwIDggMmE2IDYgMCAwIDAgMCAxMloiIGZpbGw9IiM0RkJBRjciLz4KUGF0aCBkPSJtNS45MyA4LjM4IDEuMDYgMS4wNmEuNzUuNzUgMCAwIDAgMS4wNiAwbDMuOC0zLjhhLjc1Ljc1IDAgMCAwLTEuMDYtMS4wNkw4IDcuMzJsLS43OS0uNzlhLjc1Ljc1IDAgMCAwLTEuMDYgMS4wNmwtLjIyLjIxeiIgZmlsbD0iI2ZmZiIvPgo8L3N2Zz4=\';\nfunction OnNewShellUI(shellUI) {\n  shellUI.Events.Register(MFiles.Event.NewShellFrame, handleNewShellFrame);\n}\n\nfunction handleNewShellFrame(shellFrame) {\n  shellFrame.Events.Register(MFiles.Event.Started, getShellFrameStartedHandler(shellFrame));\n}\n\nfunction getShellFrameStartedHandler(shellFrame) {\n    return async () => {\n    // Create a taskbar group with icon\n    const reportingGroup = await shellFrame.Commands.CreateTaskbarGroup(\n        "Reporting Tools",\n        MFiles.MenuLocation.MenuLocation_TaskBar_MainActions,\n        1\n    );\n\n    // Create commands for the group\n    const generateReportCommand = await shellFrame.Commands.CreateCustomCommand("Generate Report");\n    const viewAnalyticsCommand = await shellFrame.Commands.CreateCustomCommand("View Analytics");\n   \n    // Add commands to the group\n    await shellFrame.Commands.AddCustomCommandToMenu(generateReportCommand, reportingGroup, 1);\n    await shellFrame.Commands.AddCustomCommandToMenu(viewAnalyticsCommand, reportingGroup, 2);\n   \n    // Set icon for the group\n    const groupIconInfo = {\n        content: groupIconBase64,\n        iconContentType: "BASE64",\n        alt: "Reporting tools group icon",\n        extension: "svg"\n    };\n\n    await shellFrame.Commands.SetTaskbarGroupIcon(reportingGroup, groupIconInfo);\n  };\n}\n')),(0,o.kt)("p",null,(0,o.kt)("img",{alt:" alt text ",src:a(27243).Z,title:"Custom taskbar group icon",width:"1878",height:"1040"})))}k.isMDXComponent=!0},34274:(e,n,a)=>{a.d(n,{Z:()=>t});const t={note:"note_XMqZ",idea:"idea_NLbw",highlight:"highlight_NFmx",filetitle:"filetitle_Jrus"}},70605:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/TaskbarCommands_1-75d35893f8d3b360a82383f33232b273.png"},67233:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/TaskbarCommands_2-fba3724ff895b88ef5320233316a3d75.png"},71378:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/TaskbarCommands_3-be1707f670e9c6b855dc0e1c186f9bd3.png"},27243:(e,n,a)=>{a.d(n,{Z:()=>t});const t=a.p+"assets/images/TaskbarCommands_4-59bcd3e396e8b277f50f8e0c33cd7383.png"}}]);