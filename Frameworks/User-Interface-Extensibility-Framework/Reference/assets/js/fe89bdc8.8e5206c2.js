"use strict";(self.webpackChunkuix_2=self.webpackChunkuix_2||[]).push([[6264],{3905:(e,n,t)=>{t.d(n,{Zo:()=>r,kt:()=>w});var a=t(67294);function m(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){m(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,m=function(e,n){if(null==e)return{};var t,a,m={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(m[t]=e[t]);return m}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(m[t]=e[t])}return m}var s=a.createContext({}),d=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},r=function(e){var n=d(e.components);return a.createElement(s.Provider,{value:n},e.children)},h="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,m=e.mdxType,o=e.originalType,s=e.parentName,r=i(e,["components","mdxType","originalType","parentName"]),h=d(t),u=m,w=h["".concat(s,".").concat(u)]||h[u]||c[u]||o;return t?a.createElement(w,l(l({ref:n},r),{},{components:t})):a.createElement(w,l({ref:n},r))}));function w(e,n){var t=arguments,m=n&&n.mdxType;if("string"==typeof e||m){var o=t.length,l=new Array(o);l[0]=u;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[h]="string"==typeof e?e:m,l[1]=i;for(var d=2;d<o;d++)l[d]=t[d];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},71788:(e,n,t)=>{t.d(n,{Z:()=>o});var a=t(67294),m=t(34274);function o(e){let{children:n}=e;return a.createElement("div",{className:m.Z.filetitle},n)}},84473:(e,n,t)=>{t.d(n,{Z:()=>o});var a=t(67294),m=t(34274);function o(e){let{children:n}=e;return a.createElement("span",{className:m.Z.highlight},n)}},54930:(e,n,t)=>{t.d(n,{Z:()=>o});var a=t(67294),m=t(34274);function o(e){let{children:n}=e;return a.createElement("div",{className:m.Z.idea},n)}},67012:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>g,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var a=t(87462),m=(t(67294),t(3905)),o=t(84473),l=t(71788),i=t(54930);const s={sidebar_position:2,sidebar_label:"Commands"},d="Commands",r={unversionedId:"Samples/Commands/index",id:"Samples/Commands/index",title:"Commands",description:"Overview",source:"@site/docs/Samples/Commands/index.mdx",sourceDirName:"Samples/Commands",slug:"/Samples/Commands/",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/Commands/",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Commands"},sidebar:"tutorialSidebar",previous:{title:"Hello, World",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/HelloWorld/"},next:{title:"ShowNewObjectWindow",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Samples/ShowNewObjectWindow With Blank and UserDefined Template/"}},h={},c=[{value:"Overview",id:"overview",level:2},{value:"Creating the application structure",id:"creating-the-application-structure",level:2},{value:"Creating the application definition file",id:"creating-the-application-definition-file",level:3},{value:"Creating the module",id:"creating-the-module",level:3},{value:"Creating a button in the main menu",id:"creating-a-button-in-the-main-menu",level:2},{value:"Reacting when the command is clicked",id:"reacting-when-the-command-is-clicked",level:3},{value:"Adding a command to both the main menu and the context menu",id:"adding-a-command-to-both-the-main-menu-and-the-context-menu",level:2},{value:"Adding child command to the main menu",id:"adding-child-command-to-the-main-menu",level:2},{value:"Adding child command to the context menu",id:"adding-child-command-to-the-context-menu",level:2},{value:"Adding child command to custom command",id:"adding-child-command-to-custom-command",level:3},{value:"Adding child command to exist builtin submenu",id:"adding-child-command-to-exist-builtin-submenu",level:3},{value:"Showing and hiding buttons",id:"showing-and-hiding-buttons",level:2},{value:"Testing the application",id:"testing-the-application",level:2}],u=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,m.kt)("div",n)},w=u("Tabs"),p=u("TabItem"),C={toc:c},f="wrapper";function g(e){let{components:n,...s}=e;return(0,m.kt)(f,(0,a.Z)({},C,s,{components:n,mdxType:"MDXLayout"}),(0,m.kt)("h1",{id:"commands"},"Commands"),(0,m.kt)("h2",{id:"overview"},"Overview"),(0,m.kt)("p",null,"This sample creates a basic User Interface Extensibility Framework application consisting of one ShellUI module which adds buttons to the main menu and context menu that are shown/hidden depending upon the user\u2019s actions."),(0,m.kt)("h2",{id:"creating-the-application-structure"},"Creating the application structure"),(0,m.kt)("h3",{id:"creating-the-application-definition-file"},"Creating the application definition file"),(0,m.kt)("p",null,"Into this folder we will create an application definition file. This file must be named ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"appdef.xml"),". The application will use version 4 of the client schema (as we are only targeting newer M-Files versions), and the supported platform will be set as newweb only. The application will declare a single Shell UI module (with its code in ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"main.js"),"), and no dashboards."),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"appdef.xml"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"xml",label:"XML",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.m-files.com/schemas/appdef-client-v5.xsd">\n    <guid>A50FF521-9167-4366-9CDE-6CB5C3BDDAFF</guid>\n    <name>Commands</name>\n    <version>0.1</version>\n    <description>A basic application showing how to work with commands.</description>\n    <publisher>M-Files Corporation</publisher>\n    <enabled-by-default>true</enabled-by-default>\n    <modules>\n        <module environment="shellui">\n        <file>main.js</file>\n        </module>\n    </modules>\n</application>\n')))),(0,m.kt)(i.Z,{mdxType:"Idea"},"Ensure that your application has a unique GUID by using a GUID generator."),(0,m.kt)("h3",{id:"creating-the-module"},"Creating the module"),(0,m.kt)("p",null,"Next we will create a module file to contain our actual application logic. At this point we will just register to be notified of main lifecycle events:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"We will declare a default entry point for the ShellUI module."),(0,m.kt)("li",{parentName:"ul"},"We will react to the ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"NewShellFrame")," event and obtain a reference to the shell frame."),(0,m.kt)("li",{parentName:"ul"},"We will react to the shell frame\u2019s ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"Started")," event (as using the shell frame before this point will result in an exception).")),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {};\n}\n')))),(0,m.kt)("h2",{id:"creating-a-button-in-the-main-menu"},"Creating a button in the main menu"),(0,m.kt)("p",null,"Adding a button into the main menu involves two steps:"),(0,m.kt)("ol",null,(0,m.kt)("li",{parentName:"ol"},"Creating a new ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"ICommand")," using CreateCustomCommand."),(0,m.kt)("li",{parentName:"ol"},"Adding the command into the menu using AddCustomCommandToMenu.")),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Add the first command to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n    };\n}\n')))),(0,m.kt)("p",null,"Logging into the M-Files vault should now show a button in the main menu (three dot menu near user icon) with the text ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"My First Command"),":"),(0,m.kt)("p",null,(0,m.kt)("img",{alt:" alt text ",src:t(55186).Z,title:"First command",width:"1253",height:"312"})),(0,m.kt)("h3",{id:"reacting-when-the-command-is-clicked"},"Reacting when the command is clicked"),(0,m.kt)("p",null,"Reacting to a command being clicked involves three steps:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"Register to be notified of the CustomCommand event."),(0,m.kt)("li",{parentName:"ul"},"Ensure that the command that was clicked was the one we want to handle."),(0,m.kt)("li",{parentName:"ul"},"Execute the required code.")),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Add the first command to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n                }\n            } );\n\n    };\n}\n')))),(0,m.kt)("p",null,(0,m.kt)("img",{alt:" alt text ",src:t(53016).Z,title:"First command clicked",width:"1062",height:"364"})),(0,m.kt)("h2",{id:"adding-a-command-to-both-the-main-menu-and-the-context-menu"},"Adding a command to both the main menu and the context menu"),(0,m.kt)("p",null,"To add a command created with CreateCustomCommand to the context menu, call AddCustomCommandToMenu. In the example below, it is the same command object added to both main menu and context menu, so our code to react when the button is clicked will be fired for the context menu item and the main menu item."),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first command to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n                }\n            } );\n\n    };\n}\n')))),(0,m.kt)("p",null,(0,m.kt)("img",{alt:" alt text ",src:t(77504).Z,title:"Context menu",width:"1076",height:"882"})),(0,m.kt)("h2",{id:"adding-child-command-to-the-main-menu"},"Adding child command to the main menu"),(0,m.kt)("p",null,"Adding a child button into the main menu involves two steps:"),(0,m.kt)("ol",null,(0,m.kt)("li",{parentName:"ol"},"Creating a new ",(0,m.kt)("inlineCode",{parentName:"li"},"ICommand")," using CreateCustomCommand."),(0,m.kt)("li",{parentName:"ol"},"Adding the command into main menu using CreateSubMenuItem by giving the parent command id.")),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first and second commands to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        const parentMenuItemId = await shellFrame.Commands.AddCustomCommandToMenu( commandTwoId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Create child commands (buttons).\n        const commandChildOneId = await shellFrame.Commands.CreateCustomCommand( "My First Child Command" );\n        const commandChildTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Child Command" );\n\n        // Add created child comamnds to the parent.\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n\n                    case commandChildOneId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My child command clicked." );\n                        break;\n                }\n            } );\n    };\n}\n')))),(0,m.kt)("p",null,(0,m.kt)("img",{alt:" alt text ",src:t(62366).Z,title:"Child Command",width:"1252",height:"407"})),(0,m.kt)("h2",{id:"adding-child-command-to-the-context-menu"},"Adding child command to the context menu"),(0,m.kt)("h3",{id:"adding-child-command-to-custom-command"},"Adding child command to custom command"),(0,m.kt)("p",null,"Adding a child button to custom command involves two steps:"),(0,m.kt)("ol",null,(0,m.kt)("li",{parentName:"ol"},"Creating a new ",(0,m.kt)("inlineCode",{parentName:"li"},"ICommand")," using CreateCustomCommand."),(0,m.kt)("li",{parentName:"ol"},"Adding the command into context menu using CreateSubMenuItem by giving the parent command id.")),(0,m.kt)("h3",{id:"adding-child-command-to-exist-builtin-submenu"},"Adding child command to exist builtin submenu"),(0,m.kt)("p",null,"Adding a child button to exist builtin submenu command involves three steps:"),(0,m.kt)("ol",null,(0,m.kt)("li",{parentName:"ol"},"Creating a new ",(0,m.kt)("inlineCode",{parentName:"li"},"ICommand")," using CreateCustomCommand."),(0,m.kt)("li",{parentName:"ol"},"Getting parent menu item id using GetMenuIdOfBuiltInCommand."),(0,m.kt)("li",{parentName:"ol"},"Adding the command into context menu using CreateSubMenuItem by giving the parent menu item id.")),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first and second commands to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        const parentMenuItemId = await shellFrame.Commands.AddCustomCommandToMenu( commandTwoId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Create child commands (buttons).\n        const commandChildOneId = await shellFrame.Commands.CreateCustomCommand( "My First Child Command" );\n        const commandChildTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Child Command" );\n\n        // Add created child comamnds to the parent.\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n        // Create child command to add exist submenu in the listing context menu.\n        const commandChildThreeId = await shellFrame.Commands.CreateCustomCommand( "My Custom Convert Command" );\n\n        // Get built in parent command menu id. Ex. Convert.\n        const convertMenuId = await shellFrame.Commands.GetMenuIdOfBuiltInCommand( MFiles.BuiltinCommand.SubMenu_Convert, MFiles.CommandLocation.ContextMenu );\n\n        // Add child command to the exist convert menu.\n        await shellFrame.Commands.CreateSubMenuItem( convertMenuId, commandChildThreeId, 0 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n\n                    case commandChildOneId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My child command clicked." );\n                        break;\n                }\n            } );\n    };\n}\n')))),(0,m.kt)("p",null,(0,m.kt)("img",{alt:" alt text ",src:t(49782).Z,title:"Child Command",width:"1568",height:"876"})),(0,m.kt)("h2",{id:"showing-and-hiding-buttons"},"Showing and hiding buttons"),(0,m.kt)("p",null,"The visibility of commands can be controlled by calling ",(0,m.kt)(o.Z,{mdxType:"Highlight"},"SetCommandState"),". To show this, we will toggle the first command visibility on clicking the child command."),(0,m.kt)(l.Z,{mdxType:"FileTitle"},"main.js"),(0,m.kt)(w,{mdxType:"Tabs"},(0,m.kt)(p,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-js"},'// NOTE! This code is for demonstration purposes only and does not contain any kind of\n//       error handling. MUST be revised before using in production.\n\nfunction OnNewShellUI( shellUI ) {\n\n    /// <summary>Executed by the UIX when a ShellUI module is started.</summary>\n    /// <param name="shellUI" type="MFiles.ShellUI">The shell UI object which was created.</param>\n\n    // This is the start point of a ShellUI module.\n\n    // Register to be notified when a new shell frame (MFiles.Event.NewShellFrame) is created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        handleNewShellFrame );\n}\n\nfunction handleNewShellFrame( shellFrame ) {\n\n    /// <summary>Handles the OnNewNormalShellFrame event for an IShellUI.</summary>\n    /// <param name="shellFrame" type="MFiles.ShellFrame">The shell frame object which was created.</param>\n\n    // The shell frame was created but it cannot be used yet.\n    // The following line would throw an exception ("The object cannot be accessed, because it is not ready."):\n    // shellFrame.ShowMessage("A shell frame was created");\n\n    // Register to be notified when the shell frame is started.\n    shellFrame.Events.Register(\n        MFiles.Event.Started,\n        getShellFrameStartedHandler( shellFrame ) );\n}\n\nfunction getShellFrameStartedHandler( shellFrame )  {\n\n    /// <summary>Returns a function which handles the OnStarted event for an IShellFrame.</summary>\n\n    // The shell frame is now started and can be used.\n\n    return async () => {\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandOneId = await shellFrame.Commands.CreateCustomCommand( "My First Command" );\n\n        // Create a command (button).  Note that it is not yet visible.\n        const commandTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Command" );\n\n        // Add the first command to the context menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, 1 );\n\n        // Add the first and second commands to the main menu.\n        await shellFrame.Commands.AddCustomCommandToMenu( commandOneId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n        const parentMenuItemId = await shellFrame.Commands.AddCustomCommandToMenu( commandTwoId, MFiles.MenuLocation.MenuLocation_TopPaneMenu, 1 );\n\n        // Create child commands (buttons).\n        const commandChildOneId = await shellFrame.Commands.CreateCustomCommand( "My First Child Command" );\n        const commandChildTwoId = await shellFrame.Commands.CreateCustomCommand( "My Second Child Command" );\n\n        // Add created child commands to the parent in the main menu.\n        await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\n        const childMenuItem = await shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n        // Create nested child command and add to the parent in the main menu.\n        const toggleCommand = await shellFrame.Commands.CreateCustomCommand( "Toggle First Command Visibility" );\n        await shellFrame.Commands.CreateSubMenuItem( childMenuItem, toggleCommand, 1 );\n\n        // Create child command to add exist submenu in the listing context menu.\n        const commandChildThreeId = await shellFrame.Commands.CreateCustomCommand( "My Custom Convert Command" );\n\n        // Get built in parent command menu id. Ex. Convert.\n        const convertMenuId = await shellFrame.Commands.GetMenuIdOfBuiltInCommand( MFiles.BuiltinCommand.SubMenu_Convert, MFiles.CommandLocation.ContextMenu );\n\n        // Add child command to the exist convert menu.\n        await shellFrame.Commands.CreateSubMenuItem( convertMenuId, commandChildThreeId, 0 );\n\n        // Register to be notified when a custom command is clicked.\n        // Note: this will fire for ALL custom commands, so we need to filter out others.\n        shellFrame.Commands.Events.Register(\n            MFiles.Event.CustomCommand,\n            async ( commandId ) => {\n\n                // Branch depending on the Id of the command that was clicked.\n                switch (commandId) {\n                    case commandOneId:\n\n                        // Our first command was clicked.\n                        await shellFrame.ShowMessage( "My first command clicked." );\n                        break;\n\n                    case commandChildOneId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My child command clicked." );\n                        break;\n\n                    case commandChildThreeId:\n\n                        // Our child command was clicked.\n                        await shellFrame.ShowMessage( "My convert child command clicked." );\n                        break;\n\n                    case toggleCommand:\n\n                        // Get the first command state and toggle it.\n                        let firstCommandState = await shellFrame.Commands.GetCommandState( commandOneId, MFiles.CommandLocation.MainMenu, false, false );\n                        firstCommandState = firstCommandState === MFiles.CommandState.CommandState_Hidden\n                            ? MFiles.CommandState.CommandState_Active\n                            : MFiles.CommandState.CommandState_Hidden;\n\n                        // Toggle the command state and show message.\n                        await shellFrame.Commands.SetCommandState( commandOneId, MFiles.CommandLocation.All, firstCommandState );\n\n                        // Show the message.\n                        const message = firstCommandState === MFiles.CommandState.CommandState_Active\n                            ? "First command visibility enabled"\n                            : "First command visibility disabled"\n                        await shellFrame.ShowMessage( message );\n                        break;\n                }\n            } );\n    };\n}\n')))),(0,m.kt)("h2",{id:"testing-the-application"},"Testing the application"),(0,m.kt)("p",null,(0,m.kt)("img",{alt:" alt text ",src:t(61174).Z,title:"Hide Show Commands",width:"1924",height:"881"}),"\n",(0,m.kt)("img",{alt:" alt text ",src:t(5889).Z,title:"Hide Show Commands",width:"1924",height:"881"})))}g.isMDXComponent=!0},34274:(e,n,t)=>{t.d(n,{Z:()=>a});const a={note:"note_XMqZ",idea:"idea_NLbw",highlight:"highlight_NFmx",filetitle:"filetitle_Jrus"}},55186:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_1-7155073040a14531cef4b5c3b51626dc.png"},53016:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_2-49f709618eb706dd5912f5c52df7a1c3.png"},77504:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_3-c8148bb22e501e5471b6553619f7323b.png"},62366:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_4-3f91ab15528b6cb15a47a4a0ddc4b745.png"},49782:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_5-ae3f172688624599f4c8b8c7c38b2c16.png"},61174:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_6-908cf9e788788160cce212b046b6349f.png"},5889:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_7-1aa8073379e40aaf90e8b07fbafe0840.png"}}]);