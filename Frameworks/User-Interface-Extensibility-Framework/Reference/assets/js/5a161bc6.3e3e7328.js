"use strict";(self.webpackChunkuix_2=self.webpackChunkuix_2||[]).push([[9882],{3905:(e,n,t)=>{t.d(n,{Zo:()=>l,kt:()=>h});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},m=Object.keys(e);for(a=0;a<m.length;a++)t=m[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(e);for(a=0;a<m.length;a++)t=m[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),d=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},l=function(e){var n=d(e.components);return a.createElement(s.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,m=e.originalType,s=e.parentName,l=r(e,["components","mdxType","originalType","parentName"]),c=d(t),p=o,h=c["".concat(s,".").concat(p)]||c[p]||u[p]||m;return t?a.createElement(h,i(i({ref:n},l),{},{components:t})):a.createElement(h,i({ref:n},l))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var m=t.length,i=new Array(m);i[0]=p;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r[c]="string"==typeof e?e:o,i[1]=r;for(var d=2;d<m;d++)i[d]=t[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},27995:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var a=t(87462),o=(t(67294),t(3905)),m=(t(47713),t(9826));t(45274);const i={sidebar_position:5},r="Using Custom Commands",s={unversionedId:"Overview/Commands",id:"Overview/Commands",title:"Using Custom Commands",description:"The Custom Commands interface provides a set of commands for customizing menus, creating custom commands, and managing their states in M-Files UI Extensions. The ICommands provides set of tools for developers to customize the user interface, manage commands, and control their visibility and availability within the application.",source:"@site/docs/Overview/Commands.mdx",sourceDirName:"Overview",slug:"/Overview/Commands",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Overview/Commands",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Dialogs and Messages",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Overview/Messages"},next:{title:"Working with the Shell Listing",permalink:"/Frameworks/User-Interface-Extensibility-Framework/Reference/Overview/ListingView"}},d={},l=[{value:"Managing Commands",id:"managing-commands",level:2},{value:"Creating a Custom Command",id:"creating-a-custom-command",level:3},{value:"Controlling the Command visibility",id:"controlling-the-command-visibility",level:3},{value:"Executing the Command manually",id:"executing-the-command-manually",level:3},{value:"Listening and Responding to Custom Commands",id:"listening-and-responding-to-custom-commands",level:3},{value:"Command locations",id:"command-locations",level:2},{value:"The context menu",id:"the-context-menu",level:3},{value:"The main menu",id:"the-main-menu",level:3},{value:"Child commands",id:"child-commands",level:4},{value:"Icons",id:"icons",level:2},{value:"Example of setting an icon from a relative path for a custom command.",id:"example-of-setting-an-icon-from-a-relative-path-for-a-custom-command",level:3},{value:"IIconInformation configuration examples for other content types.",id:"iiconinformation-configuration-examples-for-other-content-types",level:3},{value:"SVG string icon:",id:"svg-string-icon",level:4},{value:"Base64 string:",id:"base64-string",level:4},{value:"Using built-in icons:",id:"using-built-in-icons",level:3}],c={toc:l},u="wrapper";function p(e){let{components:n,...i}=e;return(0,o.kt)(u,(0,a.Z)({},c,i,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"using-custom-commands"},"Using Custom Commands"),(0,o.kt)("p",null,"The Custom Commands interface provides a set of commands for customizing menus, creating custom commands, and managing their states in M-Files UI Extensions. The ",(0,o.kt)("a",{parentName:"p",href:"../../UIExt2/Interfaces/ICommands/"},"ICommands")," provides set of tools for developers to customize the user interface, manage commands, and control their visibility and availability within the application."),(0,o.kt)("h2",{id:"managing-commands"},"Managing Commands"),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"ICommands is part of ",(0,o.kt)("a",{parentName:"p",href:"../../UIExt2/Interfaces/IShellFrame/"},"IShellFrame")," interface. To use this interface you have to first obtain instance of the IShellFrame. ")),(0,o.kt)("h3",{id:"creating-a-custom-command"},"Creating a Custom Command"),(0,o.kt)("p",null,"The commands created by the ICommands interface are usually so called ",(0,o.kt)("strong",{parentName:"p"},"Custom Commands")," which are available only for your UI Extension application."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Create a new custom command using IShellFrame instance.\nconst commandId = await shellFrame.Commands.CreateCustomCommand(name);\n")),(0,o.kt)("h3",{id:"controlling-the-command-visibility"},"Controlling the Command visibility"),(0,o.kt)("p",null,"Creating a command does not automatically add the command to the user interface.  To do that the ",(0,o.kt)("a",{parentName:"p",href:"../../UIExt2/Interfaces/ICommands/SetCommandState"},"SetCommandState")," method must be used.  This method defines the command state (hidden/visible) in specific parts of the user interface:"),(0,o.kt)(m.ZP,{components:i.components,mdxType:"SetCommandState"}),(0,o.kt)("h3",{id:"executing-the-command-manually"},"Executing the Command manually"),(0,o.kt)("p",null,"The Custom command can executed directly using ",(0,o.kt)("a",{parentName:"p",href:"../../UIExt2/Interfaces/ICommands/ExecuteCommand"},"ExecuteCommand"),", which accepts also optional ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," parameter."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," must be serializeable using ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm"},"Structured Cloning Algorithm"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Execute a new custom command with data parameter\nawait shellFrame.Commands.ExecuteCommand(commandId, {\n    someCustomData: 1234\n});\n")),(0,o.kt)("h3",{id:"listening-and-responding-to-custom-commands"},"Listening and Responding to Custom Commands"),(0,o.kt)("p",null,"User can listen to cuostom command events using ",(0,o.kt)("inlineCode",{parentName:"p"},"MFiles.Event.CustomCommand"),", which has a callback having parameters ",(0,o.kt)("inlineCode",{parentName:"p"},"(commandId, data)"),"."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"It is generally recommended to have a single listener function for custom commands to avoid responding to the same command multiple times.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"\n// Listen for the custom commands.\nshellFrame.Commands.Events.Register(\n\n    // Listen for the CustomCommand events.\n    MFiles.Event.CustomCommand,\n\n    // Each command has ID and optional data provided with it.\n    ( commandId, data ) => {\n    }\n);\n\n")),(0,o.kt)("h2",{id:"command-locations"},"Command locations"),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("a",{parentName:"p",href:"../../Samples/Commands"},"commands sample")," includes practical examples of code that adds commands to different locations.")),(0,o.kt)("p",null,"Commands can be shown in two primary locations: within the context menu (shown when the user right-clicks on something in a listing), and within the main menu."),(0,o.kt)("h3",{id:"the-context-menu"},"The context menu"),(0,o.kt)("p",null,"Commands can be added to the context menu which is shown when a user right-clicks on something in a listing.  The command may be shown similarly to this:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"The command shown in the context menu",src:t(77504).Z,width:"1076",height:"882"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'// This code should be placed to run when the shell frame is started.\n\n// Create the command.\nconst commandOneId = await shellFrame.Commands.CreateCustomCommand\n(\n    "My First Command"\n);\n\n// Add the command to the bottom of the context menu.\nawait shellFrame.Commands.AddCustomCommandToMenu\n(\n    commandOneId,\n    MFiles.MenuLocation.MenuLocation_ContextMenu_Bottom, // Note: context menu\n    1\n);\n\n// Show a message when the command is clicked.\nshellFrame.Commands.Events.Register(\n    MFiles.Event.CustomCommand,\n    async ( commandId ) => {\n\n        // If something other than our command was clicked then die.\n        if(commandId !== commandOneId)\n            return;\n            \n        // Our context menu command was clicked.\n        await shellFrame.ShowMessage( "My context menu command was clicked." );\n    }\n);\n')),(0,o.kt)("h3",{id:"the-main-menu"},"The main menu"),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("a",{parentName:"p",href:"../../Samples/Commands"},"commands sample")," includes practical examples of code that adds commands to different locations.")),(0,o.kt)("p",null,'Commands can be added to the "main menu", which is located at the top-right of the user interface, as a three-dot icon.  Clicking this icon expands the menu and shows commands added to the menu.'),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The main menu is not shown until one or more UI Extensions add commands to this location.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'// This code should be placed to run when the shell frame is started.\n\n// Create the command.\nconst commandOneId = await shellFrame.Commands.CreateCustomCommand\n(\n    "My First Command"\n);\n\n// Add the command to the main menu.\nawait shellFrame.Commands.AddCustomCommandToMenu\n(\n    commandOneId,\n    MFiles.MenuLocation.MenuLocation_TopPaneMenu, // Note: top pane menu\n    1\n);\n\n// Show a message when the command is clicked.\nshellFrame.Commands.Events.Register(\n    MFiles.Event.CustomCommand,\n    async ( commandId ) => {\n\n        // If something other than our command was clicked then die.\n        if(commandId !== commandOneId)\n            return;\n            \n        // Our context menu command was clicked.\n        await shellFrame.ShowMessage( "My top menu command was clicked." );\n    }\n);\n')),(0,o.kt)("h4",{id:"child-commands"},"Child commands"),(0,o.kt)("p",null,"The main menu supports commands with sub-menu commands.  This functionality allows you to group commands logically by function within your application:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"A main menu command with sub-menu commands",src:t(62366).Z,width:"1252",height:"407"})),(0,o.kt)("p",null,"To do this, create the parent command and then call ",(0,o.kt)("inlineCode",{parentName:"p"},"CreateSubMenuItem")," to create child commands:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'// This code should be placed to run when the shell frame is started.\n\n// Create the parent command.\nconst commandOneId = await shellFrame.Commands.CreateCustomCommand\n(\n    "My First Command"\n);\n\n// Add the parent command to the main menu.\nconst parentMenuItemId  = await shellFrame.Commands.AddCustomCommandToMenu\n(\n    commandOneId,\n    MFiles.MenuLocation.MenuLocation_TopPaneMenu, // Note: top pane menu\n    1\n);\n\n // Create child commands (buttons).\nconst commandChildOneId = await shellFrame.Commands.CreateCustomCommand\n(\n    "My First Child Command"\n);\nconst commandChildTwoId = await shellFrame.Commands.CreateCustomCommand\n(\n    "My Second Child Command"\n);\n\n// Add the child commands to the parent.\nawait shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildOneId, 1 );\nawait shellFrame.Commands.CreateSubMenuItem( parentMenuItemId, commandChildTwoId, 1 );\n\n\n// Show a message when the command is clicked.\nshellFrame.Commands.Events.Register(\n    MFiles.Event.CustomCommand,\n    async ( commandId ) => {\n\n        // Only react when the child commands are clicked.\n        if(commandId !== commandChildOneId && commandId !== commandChildTwoId)\n            return;\n            \n        // One of the two child commands was clicked.\n        await shellFrame.ShowMessage( "One of the child commands was clicked!" );\n    }\n);\n')),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Context menus do not currently support child commands.")),(0,o.kt)("h2",{id:"icons"},"Icons"),(0,o.kt)("p",null,"Commands support icons in all menu locations."),(0,o.kt)("h1",{id:"a-main-menu-command-with-sub-menu-commands"},(0,o.kt)("img",{alt:"A main menu command with sub-menu commands",src:t(76150).Z,width:"1996",height:"1166"})),(0,o.kt)("p",null,"Adding an icon for command can be done using SetIcon method with IIconInformation configuration."),(0,o.kt)("h3",{id:"example-of-setting-an-icon-from-a-relative-path-for-a-custom-command"},"Example of setting an icon from a relative path for a custom command."),(0,o.kt)("p",null,"First, create a custom command ID. Next, add the necessary information to the icon information object to set the actual icon. Finally, add the command to any menu location. All current menu locations are supported, and the added icon will appear on the left side of the menu item."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'// This code should be placed to run when the shell frame is started.\n\n// Create custom command ID.\nconst customCommand = await shellFrame.Commands.CreateCustomCommand("Custom command");\n\n// Create icon information.\nconst iconIdInformation = { \n    content: "assets/icons/customCommandIcon.svg", \n    iconContentType: "PATH",\n    alt: "Custom command icon alt",\n    extension: "svg" \n};\n\n// Set icon for created command ID.\nawait shellFrame.Commands.SetIcon(commandCheckoutId, iconIdInformation);\n\n// Add command to the taskbar menu location.\nawait shellFrame.Commands.AddCustomCommandToMenu(commandCheckoutId, MFiles.MenuLocation.MenuLocation_TaskBar_MainActions, 1);\n')),(0,o.kt)("h3",{id:"iiconinformation-configuration-examples-for-other-content-types"},"IIconInformation configuration examples for other content types."),(0,o.kt)("h4",{id:"svg-string-icon"},"SVG string icon:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// Icon in SVG string format.\nconst svgStringIcon = \"<svg width='16' height='16' viewBox='0 0 16 16' fill='none' xmlns='http://www.w3.org/2000/svg'><rect x='1' y='14' width='14' height='1' rx='0.5' fill='#363A40'/><circle cx='3' cy='7' r='1.5' stroke='#363A40'/><path d='M5 8L6.5 10.5' stroke='#363A40'/><circle cx='8' cy='11' r='1.5' stroke='#363A40'/><circle cx='13' cy='3' r='1.5' stroke='#363A40'/><path d='M12.5 4L9 9.5' stroke='#363A40'/></svg>\";\n\n// Create iconInformation object.\nconst iconIdInformation = { \n    content: svgStringIcon, \n    iconContentType: \"SVG\",\n    alt: \"Custom command SVG string icon alt\",\n    extension: \"svg\" \n};\n")),(0,o.kt)("h4",{id:"base64-string"},"Base64 string:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'// Icon in base64 string format.\nconst base64StringIcon = "PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMSIgeT0iMTQiIHdpZHRoPSIxNCIgaGVpZ2h0PSIxIiByeD0iMC41IiBmaWxsPSIjMzYzQTQwIi8+CjxjaXJjbGUgY3g9IjMiIGN5PSI3IiByPSIxLjUiIHN0cm9rZT0iIzM2M0E0MCIvPgo8cGF0aCBkPSJNNSA4TDYuNSAxMC41IiBzdHJva2U9IiMzNjNBNDAiLz4KPGNpcmNsZSBjeD0iOCIgY3k9IjExIiByPSIxLjUiIHN0cm9rZT0iIzM2M0E0MCIvPgo8Y2lyY2xlIGN4PSIxMyIgY3k9IjMiIHI9IjEuNSIgc3Ryb2tlPSIjMzYzQTQwIi8+CjxwYXRoIGQ9Ik0xMi41IDRMOSA5LjUiIHN0cm9rZT0iIzM2M0E0MCIvPgo8L3N2Zz4K";\n\n// Create iconInformation object.\nconst iconIdInformation = { \n    content: base64StringIcon, \n    iconContentType: "BASE64",\n    alt: "Custom command SVG base64 string icon alt",\n    extension: "svg"\n};\n')),(0,o.kt)("p",null,"Note: With Base64 string, extension information must be provided in order to handle icon information correctly."),(0,o.kt)("h3",{id:"using-built-in-icons"},"Using built-in icons:"),(0,o.kt)("p",null,"It is possible to use built-in icons for commands. See available built-in icon IDs from the BuiltInIcon enumeration in the IIconInformation interface."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'    // Create iconInformation object for builtin Checkout icon.\n    const iconIdInformation = { \n        content: 0,\n        iconContentType: "BUILT_IN", \n        alt: `built-in icon alt`, \n        extension: "" \n    };\n')))}p.isMDXComponent=!0},47713:(e,n,t)=>{t.d(n,{ZP:()=>r});var a=t(87462),o=(t(67294),t(3905));const m={toc:[]},i="wrapper";function r(e){let{components:n,...t}=e;return(0,o.kt)(i,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Value"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"CommandState_Undefined")),(0,o.kt)("td",{parentName:"tr",align:null},"0"),(0,o.kt)("td",{parentName:"tr",align:null},"Undefined value.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"CommandState_Active")),(0,o.kt)("td",{parentName:"tr",align:null},"1"),(0,o.kt)("td",{parentName:"tr",align:null},"The command is visible and enabled.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"CommandState_Hidden")),(0,o.kt)("td",{parentName:"tr",align:null},"3"),(0,o.kt)("td",{parentName:"tr",align:null},"The command is not visible.")))))}r.isMDXComponent=!0},9826:(e,n,t)=>{t.d(n,{ZP:()=>r});var a=t(87462),o=(t(67294),t(3905));const m={toc:[]},i="wrapper";function r(e){let{components:n,...t}=e;return(0,o.kt)(i,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"shellFrame.Commands.SetCommandState( \n    commandId, // The ID of the command which state is to be changed\n    MFiles.MenuLocation.MenuLocation_TopPaneMenu, // The menu location of the change\n    MFiles.CommandState.CommandState_Hidden  // New state of the command in specific location or\n);\n")))}r.isMDXComponent=!0},45274:(e,n,t)=>{t(87462),t(67294),t(3905),t(7606),t(94642),t(37415),t(47713),t(9826)},37415:(e,n,t)=>{t.d(n,{ZP:()=>r});var a=t(87462),o=(t(67294),t(3905));const m={toc:[]},i="wrapper";function r(e){let{components:n,...t}=e;return(0,o.kt)(i,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,'This JavaScript code is a UI Extension for M-Files, creating custom commands such as "Hello World" and providing functionality to dynamically show, hide, and remove these commands from the top menu based on user interactions within the M-Files shell.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'\n// Called when the UI Extension starts\nfunction OnNewShellUI(shellUI) {\n\n    // Wait for the ShellFrame to be created.\n    shellUI.Events.Register(\n        MFiles.Event.NewShellFrame,\n        async (shellFrame) => {\n\n            // Wait for the shellframe to start\n            shellFrame.Events.Register( \n                MFiles.Event.Started,\n                async () => {\n\n                    // Create a new custom command and menu item for the command\n                    const createCommand = async ( name: string ) => {\n\n                        // Create a new custom command\n                        const commandId = await shellFrame.Commands.CreateCustomCommand(name);\n\n                        // Add the command to the top menu\n                        const menuItemId = await shellFrame.Commands.AddCustomCommandToMenu(\n                            // Command ID\n                            commands.exampleCommand,\n                            // Menulocation\n                            MFiles.MenuLocation.MenuLocation_TopPaneMenu, \n                            // Priority of the command\n                            1 \n                        );\n\n                        // Return a data structure containing essential information about the commands\n                        return {\n                            id: commandId, // ID of the command\n                            menuItemId     // Menu item ID, can be used to add sub menus to this menu item.\n                        }\n                    }\n\n                    // Create an Example command and a set of sample commands to control it\'s visibility\n                    const commands = {\n                        // This is the sample command\n                        exampleCommand : await createCommand("Hello World"),\n\n                        // These commands control the state of the example command\n                        addCommand: await createCommand("Add Command To Menu"),\n                        deleteCustomCommand: await createCommand("Delete Command")\n                        hideCommand: await createCommand("Hide Command"),\n                        showCommand: await createCommand("Activate Command"),\n                        executeCommand: await createCommand("Execute Command"),\n                        getCommandName: await createCommand("Get Name"),\n                        getCommandState: await createCommand("Get Command State"),\n                        removeCommandFromMenu: await createCommand("Remove From Menu"), \n                        removeCommand: await createCommand("Remove Command")\n                    }\n\n                    // Add the command to the top menu\n                    const menuItemId = await shellFrame.Commands.AddCustomCommandToMenu(\n                        commands.exampleCommand,, \n                        MFiles.MenuLocation.MenuLocation_TopPaneMenu, \n                        1 // Priority of the command\n                    );\n\n                    // Listen for the custom commands.\n                    shellFrame.Commands.Events.Register(\n\n                        // Listen for the CustomCommand events.\n                        MFiles.Event.CustomCommand,\n\n                        // Each command has ID and optional data provided with it.\n                        ( commandId, data ) => {\n                            // Respond to the command if custom command sent by the application \n                            switch( commandId ) {\n\n                                // Run the Example command\n                                case commands.exampleCommand.id:\n                                    shellFrame.ShowMessage( "Hello World!" );\n                                    break;\n\n                                // Add the new menuitem which runs the example command\n                                case commands.addCommand.id:\n                                    await shellFrame.Commands.AddCustomCommandToMenu(\n                                        commands.exampleCommand, \n                                        MFiles.MenuLocation.MenuLocation_TopPaneMenu, \n                                        1 // Priority of the command\n                                    );\n                                    break;\n\n                                // Removes the command from particular menu\n                                case commands.removeCommandFromMenu.id:\n                                    await shellFrame.Commands.RemoveCustomCommandFromMenu(\n                                        commands.exampleCommand,, \n                                        MFiles.MenuLocation.MenuLocation_TopPaneMenu\n                                    );\n                                    break;\n\n                                // Deletes the command permanently\n                                case commands.deleteCommand.id:\n                                    shellFrame.Commands.SetCommandState( \n                                        commandId, \n                                        MFiles.CommandLocation.MainMenu,\n                                        MFiles.CommandState.CommandState_Active\n                                    );\n                                    break;\n\n                                // Hiddes all command instances for specific command ID\n                                case commands.hideCommand.id:\n                                     // Hide the command \n                                    shellFrame.Commands.SetCommandState( \n                                        commandId, \n                                        MFiles.CommandLocation.MainMenu,\n                                        MFiles.CommandState.CommandState_Hidden\n                                    );\n                                    break;\n\n                                // Activates (makes visible) all command instances for specific command ID\n                                case commands.showCommand.id:\n                                     // Show the command \n                                    shellFrame.Commands.SetCommandState( \n                                        commandId, \n                                        MFiles.MenuLocation.MenuLocation_TopPaneMenu,\n                                        MFiles.CommandState.CommandState_Active\n                                    );\n                                    break;\n\n                                // Get the command name\n                                case commands.getCommandName.id:\n                                    const name = await shellFrame.Commands.getCommandName(commands.exampleCommand.id);\n                                    shellFrame.ShowMessage( name );\n                                    break;\n\n                                // Get the Command State\n                                case commands.getCommandState.id:\n\n                                    // NOTE: the MFiles.CommandLocation.MainMenu must be used to get state of items added to the Top Menu\n                                    const commandState = await shellFrame.Commands.getCommandState(commands.exampleCommand.id, MFiles.CommandLocation.MainMenu );\n                                    shellFrame.ShowMessage( `Command state: ${commandState}` );\n                                    break;\n\n                            }\n                        }\n                    );\n                }\n            )\n        }\n    )\n}\n')),(0,o.kt)("p",null,"This code is essentially setting up a simple UI extension with custom commands that can be triggered from the top menu, and it allows dynamic control over the visibility of these commands based on user interactions."))}r.isMDXComponent=!0},7606:(e,n,t)=>{t.d(n,{ZP:()=>r});var a=t(87462),o=(t(67294),t(3905));const m={toc:[]},i="wrapper";function r(e){let{components:n,...t}=e;return(0,o.kt)(i,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./AddCustomCommandToMenu/"},"AddCustomCommandToMenu")),(0,o.kt)("td",{parentName:"tr",align:null},"Adds existing custom command to the specified context menu location.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./CreateCustomCommand/"},"CreateCustomCommand")),(0,o.kt)("td",{parentName:"tr",align:null},"Creates a custom command that can be added to the application toolbar or to the contextmenu.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./CreateSubMenuItem/"},"CreateSubMenuItem")),(0,o.kt)("td",{parentName:"tr",align:null},"Creates a new SubMenu for already created Menu.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./CreateTaskbarGroup/"},"CreateTaskbarGroup")),(0,o.kt)("td",{parentName:"tr",align:null},"Creates new custom task bar group for custom commands. ",(0,o.kt)("br",null)," ",(0,o.kt)("br",null),"NOTE: Stability is experimental. Non-backward compatible changes or removal may occur in any ",(0,o.kt)("br",null),"future release. Use of this feature is not recommended for production environments. ",(0,o.kt)("br",null)," ",(0,o.kt)("br",null),"NOTE: If multiple task bar groups are created for the same MenuLocation with the same ",(0,o.kt)("br",null),"orderPriority, their relative ordering is unspecified and may vary between runs, sessions or ",(0,o.kt)("br",null),"versions. Do not rely on a particular order for groups with equal priority \u2014 assign distinct ",(0,o.kt)("br",null),"orderPriority values to guarantee a deterministic ordering (lower values are shown first).")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./DeleteCustomCommand/"},"DeleteCustomCommand")),(0,o.kt)("td",{parentName:"tr",align:null},"Deletes a custom command. The command is automatically removed.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./ExecuteCommand/"},"ExecuteCommand")),(0,o.kt)("td",{parentName:"tr",align:null},"Executes a user command.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./GetCommandName/"},"GetCommandName")),(0,o.kt)("td",{parentName:"tr",align:null},"Resolves the name that has been associated with the given command id.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./GetCommandState/"},"GetCommandState")),(0,o.kt)("td",{parentName:"tr",align:null},"Gets the command state for builtin or custom command in specified location.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./GetMenuIdOfBuiltInCommand/"},"GetMenuIdOfBuiltInCommand")),(0,o.kt)("td",{parentName:"tr",align:null},"Gets the MenuItem ID of a built-in command by its command ID and location.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./RemoveCustomCommandFromMenu/"},"RemoveCustomCommandFromMenu")),(0,o.kt)("td",{parentName:"tr",align:null},"Removes a custom command from the specified menu location.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./RemoveMenuItem/"},"RemoveMenuItem")),(0,o.kt)("td",{parentName:"tr",align:null},"Removes menuitem from the menu.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./RemoveTaskbarGroup/"},"RemoveTaskbarGroup")),(0,o.kt)("td",{parentName:"tr",align:null},"Removes custom task bar group from the task bar. ",(0,o.kt)("br",null)," ",(0,o.kt)("br",null),"NOTE: Stability is experimental. Non-backward compatible changes or removal may occur in any ",(0,o.kt)("br",null),"future release. Use of this feature is not recommended for production environments.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./SetCommandState/"},"SetCommandState")),(0,o.kt)("td",{parentName:"tr",align:null},"Sets the command's state to be hidden, visible, enabled or disabled. Calling ",(0,o.kt)("br",null),"this method may affect context menu, application toolbar, menus or all of them.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./SetIcon/"},"SetIcon")),(0,o.kt)("td",{parentName:"tr",align:null},"Sets the icon for a custom command. ",(0,o.kt)("br",null)," ",(0,o.kt)("br",null),"NOTE: Stability is experimental. Non-backward compatible changes or removal may occur in any ",(0,o.kt)("br",null),"future release. Use of this feature is not recommended for production environments.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./SetMenuItemState/"},"SetMenuItemState")),(0,o.kt)("td",{parentName:"tr",align:null},"Sets the MenuItem state individually.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"./SetTaskbarGroupIcon/"},"SetTaskbarGroupIcon")),(0,o.kt)("td",{parentName:"tr",align:null},"Sets the icon for a custom task bar group. ",(0,o.kt)("br",null)," ",(0,o.kt)("br",null),"NOTE: Stability is experimental. Non-backward compatible changes or removal may occur in any ",(0,o.kt)("br",null),"future release. Use of this feature is not recommended for production environments.")))))}r.isMDXComponent=!0},94642:(e,n,t)=>{t.d(n,{ZP:()=>r});var a=t(87462),o=(t(67294),t(3905));const m={toc:[]},i="wrapper";function r(e){let{components:n,...t}=e;return(0,o.kt)(i,(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Name"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Events"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/UIExt2/Events/#icommandsevents"},"ICommandsEvents")),(0,o.kt)("td",{parentName:"tr",align:null},"Returns the event registering interface of the ICommands interface.")))))}r.isMDXComponent=!0},77504:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_3-c8148bb22e501e5471b6553619f7323b.png"},62366:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_4-3f91ab15528b6cb15a47a4a0ddc4b745.png"},76150:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/Commands_8-e254bb41f0a4814a0fe6f62cd1a679cd.png"}}]);